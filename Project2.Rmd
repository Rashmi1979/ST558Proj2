---
title: "Project2"
author: "Rashmi Kadam, Dionte Watie"
date: "7/6/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


# Introduction
### For this study we will be aiming to predict the number of bike users. The bike users have been split into two groups that will be the target variables (response), casual bikers that rent bikes casually and registered bikers that rent bikes regularly. The predictor variables that will be in question are weekday (day of the week), season, hr (hour of the day), temp (temperature normalized in celsius), holiday (whether it is a holiday or not), and weathersit (weather: rainy, snowy, clear, cloudy). The response and predictor variables will be used in various Multiple Linear Regression Models, Logistics Models, and Tree fits. The models will then be tested against the testing data set and the results will determine which model would be best to use for prediction.


```{r}
library(tidyverse)
library(corrplot)
library(ggplot2)
library(ggpubr)

```



```{r}
set.seed(1)

# read Bike data
bikeData <- read_csv("day.csv")

```
```{r}

Correlation <- cor(select(bikeData,casual, registered, cnt, weekday,holiday, mnth, season,  weathersit ,yr, temp, atemp, hum, windspeed))

corrplot(Correlation)


#lmBikeData <- lm(cnt~.,data=bikeData)
#summary(lmBikeData)

```

```{r}
#Running the model

bikeDataM <- bikeData %>% filter(weekday==1) %>% select (season, holiday, mnth, weekday, weathersit, atemp, windspeed, casual, registered, cnt, yr)

bikeDataM$mnth <- as.factor(bikeDataM$mnth)


bikeDataM$season <- factor(bikeDataM$season,
                          levels = c("1", "2","3","4") , 
                          labels = c("Spring","Summer","Fall","Winter"))

table(bikeDataM$season)

bikeDataM$holiday <- factor(bikeDataM$holiday, 
                           levels = c("0", "1") , 
                           labels = c("Working Day","Holiday"))

table(bikeDataM$holiday)

bikeDataM$weathersit <- factor(bikeDataM$weathersit,
                          levels = c("1", "2","3","4") , 
                          labels = c("Good:Clear/Sunny","Moderate:Cloudy/Mist","Bad: Rain/Snow/Fog",
                                     "Worse: Heavy Rain/Snow/Fog"))
table(bikeDataM$weathersit)

bikeDataM$yr <- factor(bikeDataM$yr,
                      levels = c("0", "1") , 
                      labels = c("2011","2012"))
table(bikeDataM$yr)

```

```{r}

train <- sample(1:nrow(bikeDataM), size = nrow(bikeDataM)*0.7)
test <- dplyr::setdiff(1:nrow(bikeDataM), train)
bikeDataTrain <- bikeDataM[train, ]
bikeDataTest <- bikeDataM[test, ]


summary(bikeDataTrain)

```

```{r}

  
Year <- bikeDataTrain$yr

ggplot(bikeDataTrain, aes(fill=Year, y=cnt, x=mnth)) + 
    geom_bar(position="dodge", stat="identity") + xlab("Months") + ylab('Total Users')

```


```{r}
ggplot(bikeDataTrain, aes(x = season,y=cnt)) +
  geom_boxplot(fill="steelblue") 


```


```{r}


  #bikeDataTrain$atemp = (bikeDataTrain$atemp * 66) + 16

  cTemp <- ggplot(bikeDataTrain,aes(x=atemp, y=casual)) + geom_point() + geom_smooth() + ylim(0, 7000) 
  rTemp <- ggplot(bikeDataTrain, aes(x=atemp, y=registered)) + geom_point() + geom_smooth() + ylim(0, 7000) 
  
  ggarrange(cTemp, rTemp, labels = c("Casual Users", "Registered Users"), ncol = 2, nrow = 1)

```


```{r}
#Summary Statistics
statsCasual <- bikeDataTrain %>% group_by(mnth) %>% summarise(avg = mean(casual), med = median(casual), var = var(casual), stDev = sd(casual))
statsCasual

statsRegistered <- bikeDataTrain %>% group_by(mnth) %>% summarise(avg = mean(registered), med = median(registered), var = var(registered), stDev = sd(registered))
statsRegistered

statsCnt <- bikeDataTrain %>% group_by(season) %>% summarise(avg = mean(cnt), med = median(cnt), var = var(cnt), stDev = sd(cnt))
statsCnt
```


```{r}
tapply(bikeDataTrain$casual, INDEX = bikeDataTrain$weathersit, FUN = function(x){x -mean(x)/sd(x)})
```



```{r}

```

